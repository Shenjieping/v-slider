{"version":3,"file":"slider.js","sources":["../src/touchMixin.js","../src/util.js","../src/index.js"],"sourcesContent":["class TouchMixin {\n  constructor () {\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.offsetX = 0;\n    this.offsetY = 0;\n  }\n  touchStart = (event) => {\n    this.resetTouchStatus();\n    this.startX = event.touches[0].clientX;\n    this.startY = event.touches[0].clientY;\n  }\n  touchMove = (event) => {\n    var touch = event.touches[0];\n    this.deltaX = touch.clientX - this.startX;\n    this.deltaY = touch.clientY - this.startY;\n    this.offsetX = Math.abs(this.deltaX);\n    this.offsetY = Math.abs(this.deltaY);\n  }\n  resetTouchStatus = () => {\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.offsetX = 0;\n    this.offsetY = 0;\n  }\n}\n\nexport default TouchMixin;","export function preventDefault(event, isStopPropagation) {\n  if (typeof event.cancelable !== 'boolean' || event.cancelable) {\n    event.preventDefault();\n  }\n  if (isStopPropagation) {\n    event.stopPropagation();\n  }\n}\n\nexport function isFn (fn) {\n  return typeof fn === 'function';\n}\n\nexport function getDom (el) {\n  if (typeof el === 'string') {\n    el = document.querySelector(el);\n  }\n\n  var isDOM = typeof HTMLElement === 'object'\n    ? function (el) {\n        return el instanceof HTMLElement;\n      }\n    : function (el) {\n        return el && typeof el === 'object' && el.nodeType === 1 && typeof el.nodeName === 'string';\n      };\n  if (isDOM(el)) {\n    return el;\n  } else {\n    throw TypeError('el is not define');\n  }\n}","import TouchMixin from './touchMixin';\nimport { getDom, isFn, preventDefault } from './util';\nclass Slider {\n  constructor (options = {}) {\n    this.options = {\n      min: 0,\n      max: 100,\n      step: 1,\n      value: 0,\n      ...options\n    };\n    this.min = this.options.min;\n    this.max = this.options.max;\n    this.step = this.options.step;\n    this.value = this.options.value;\n    this.el = getDom(this.options.el);\n    this.dragStatus = '';\n    this.scope = this.max - this.min;\n    this.initHtml();\n    this.updateValue(this.value);\n    const el = this.el.querySelector('.v-slider__button-wrapper');\n    this.bindTouchEvent(el);\n    this.touchMixin = new TouchMixin();\n    this.el.addEventListener('click', this.onClick);\n  }\n  initHtml = () => {\n    const html = `\n      <div class=\"v-slider-bar\">\n        <div class=\"v-slider__button-wrapper\">\n          <div class=\"v-slider__button\"></div>\n        </div>\n      </div>\n    `;\n    this.el.innerHTML = html;\n  }\n  updateValue = (value, end) => {\n    value = this.format(value);\n    const input = this.options.input;\n    const change = this.options.change;\n    if (input) {\n      if (isFn(input)) {\n        input.call(this, value);\n      } else {\n        console.warn(`input is not a function`);\n      }\n    }\n    if (end && change) {\n      if (isFn(change)) {\n        change.call(this, value);\n      } else {\n        console.warn('change is not a function');\n      }\n    }\n    this.value = value;\n    this.render();\n  }\n  format = (value) => {\n    return (\n      Math.round(Math.max(this.min, Math.min(value, this.max)) / this.step) * this.step\n    );\n  }\n  onClick = (event) => {\n    event.stopPropagation();\n    const rect = this.el.getBoundingClientRect();\n    const delta = event.clientX - rect.left;\n    const total = rect.width;\n    let value = +this.min + (delta / total) * this.scope;\n    this.startValue = this.value;\n    this.updateValue(value, true);\n  }\n  onTouchStart = (event) => {\n    this.touchMixin.touchStart(event);\n    this.currentValue = this.value;\n    this.startValue = this.format(this.value);\n    this.dragStatus = 'start';\n  }\n  onTouchMove = (event) => {\n    const dragStart = this.options.dragStart;\n    if (this.dragStatus === 'start' && dragStart) {\n      if (isFn(dragStart)) {\n        dragStart();\n      } else {\n        console.warn('dragStart is not a function');\n      }\n    }\n    this.el.querySelector('.v-slider-bar').style.transition = 'none 0s ease 0s';\n    preventDefault(event, true);\n    this.touchMixin.touchMove(event);\n    this.dragStatus = 'draging';\n    const rect = this.el.getBoundingClientRect();\n    const delta = this.touchMixin.deltaX;\n    const total = rect.width;\n    const diff = (delta / total) * this.scope;\n\n\n    this.currentValue = this.startValue + diff;\n    this.updateValue(this.currentValue);\n  }\n  onTouchEnd = () => {\n    if (this.dragStatus === 'draging') {\n      this.updateValue(this.currentValue, true);\n      const dragEnd = this.options.dragEnd;\n      if (dragEnd) {\n        if (isFn(dragEnd)) {\n          dragEnd();\n        } else {\n          console.warn('dragEnd is not a function');\n        }\n      }\n    }\n    this.el.querySelector('.v-slider-bar').style.transition = null;\n    this.dragStatus = '';\n  }\n  bindTouchEvent = (el) => {\n    let onTouchStart = this.onTouchStart,\n        onTouchMove = this.onTouchMove,\n        onTouchEnd = this.onTouchEnd;\n    el.addEventListener('touchstart', onTouchStart);\n    el.addEventListener('touchmove', onTouchMove);\n\n    if (onTouchEnd) {\n      el.addEventListener('touchend', onTouchEnd);\n      el.addEventListener('touchcancel', onTouchEnd);\n    }\n  }\n  // 计算选中条长度百分比\n  calcMainAxis = () => {\n    const { value, min, scope } = this;\n    return `${((value - min) * 100) / scope}%`;\n  }\n  // 计算选中条开始位置的偏移量\n  calcOffset = () => {\n    const { value, min, scope } = this;\n    return null;\n  }\n  render = () => {\n    const barStyle = {\n      width: this.calcMainAxis(),\n      background: this.options.activeColor\n    };\n    const el = this.el.querySelector('.v-slider-bar');\n    el.style.width = barStyle.width;\n    el.style.background = barStyle.background;\n  }\n}\n\nexport default Slider;"],"names":["TouchMixin","event","resetTouchStatus","startX","touches","clientX","startY","clientY","touch","deltaX","deltaY","offsetX","Math","abs","offsetY","preventDefault","isStopPropagation","cancelable","stopPropagation","isFn","fn","getDom","el","document","querySelector","isDOM","HTMLElement","nodeType","nodeName","TypeError","Slider","options","html","innerHTML","value","end","format","input","change","call","console","warn","render","round","max","min","step","rect","getBoundingClientRect","delta","left","total","width","scope","startValue","updateValue","touchMixin","touchStart","currentValue","dragStatus","dragStart","style","transition","touchMove","diff","dragEnd","onTouchStart","onTouchMove","onTouchEnd","addEventListener","barStyle","calcMainAxis","background","activeColor","initHtml","bindTouchEvent","onClick"],"mappings":"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"}