{"version":3,"file":"slider.js","sources":["../src/touchMixin.js","../src/util.js","../src/index.js"],"sourcesContent":["class TouchMixin {\n  constructor () {\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.offsetX = 0;\n    this.offsetY = 0;\n  }\n  touchStart = (event) => {\n    this.resetTouchStatus();\n    this.startX = event.touches[0].clientX;\n    this.startY = event.touches[0].clientY;\n  }\n  touchMove = (event) => {\n    var touch = event.touches[0];\n    this.deltaX = touch.clientX - this.startX;\n    this.deltaY = touch.clientY - this.startY;\n    this.offsetX = Math.abs(this.deltaX);\n    this.offsetY = Math.abs(this.deltaY);\n  }\n  resetTouchStatus = () => {\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.offsetX = 0;\n    this.offsetY = 0;\n  }\n}\n\nexport default TouchMixin;","export function preventDefault(event, isStopPropagation) {\n  if (typeof event.cancelable !== 'boolean' || event.cancelable) {\n    event.preventDefault();\n  }\n  if (isStopPropagation) {\n    event.stopPropagation();\n  }\n}\n\nexport function isFn (fn) {\n  return typeof fn === 'function';\n}\n\nexport function getDom (el) {\n  if (typeof el === 'string') {\n    el = document.querySelector(el);\n  }\n\n  var isDOM = typeof HTMLElement === 'object'\n    ? function (el) {\n        return el instanceof HTMLElement;\n      }\n    : function (el) {\n        return el && typeof el === 'object' && el.nodeType === 1 && typeof el.nodeName === 'string';\n      };\n  if (isDOM(el)) {\n    return el;\n  } else {\n    throw TypeError('el is not define');\n  }\n}","import TouchMixin from './touchMixin';\nimport { getDom, isFn, preventDefault } from './util';\nclass Slider {\n  constructor (options = {}) {\n    this.options = {\n      min: 0,\n      max: 100,\n      step: 1,\n      value: 0,\n      ...options\n    };\n    this.min = this.options.min;\n    this.max = this.options.max;\n    this.step = this.options.step;\n    this.value = this.options.value;\n    this.el = getDom(this.options.el);\n    this.dragStatus = '';\n    this.scope = this.max - this.min;\n    this.initHtml();\n    this.updateValue(this.value);\n    const el = this.el.querySelector('.v-slider__button-wrapper');\n    this.bindTouchEvent(el);\n    this.touchMixin = new TouchMixin();\n    this.el.addEventListener('click', this.onClick);\n  }\n  initHtml = () => {\n    const html = `\n      <div class=\"v-slider-bar\">\n        <div class=\"v-slider__button-wrapper\">\n          <div class=\"v-slider__button\"></div>\n        </div>\n      </div>\n    `;\n    this.el.style.background = this.options.inactiveColor;\n    this.el.innerHTML = html;\n    this.el.querySelector('.v-slider__button').style.width = this.options.buttonSize;\n    this.el.querySelector('.v-slider__button').style.height = this.options.buttonSize;\n    if (this.options.barHeight) {\n      this.el.style.height = this.options.barHeight;\n      this.el.querySelector('.v-slider-bar').style.height = this.options.barHeight;\n    }\n  }\n  updateValue = (value, end) => {\n    value = this.format(value);\n    const input = this.options.input;\n    const change = this.options.change;\n    if (input) {\n      if (isFn(input)) {\n        input.call(this, value);\n      } else {\n        console.warn(`input is not a function`);\n      }\n    }\n    if (end && change) {\n      if (isFn(change)) {\n        change.call(this, value);\n      } else {\n        console.warn('change is not a function');\n      }\n    }\n    this.value = value;\n    this.render();\n  }\n  format = (value) => {\n    return (\n      Math.round(Math.max(this.min, Math.min(value, this.max)) / this.step) * this.step\n    );\n  }\n  onClick = (event) => {\n    event.stopPropagation();\n    const rect = this.el.getBoundingClientRect();\n    const delta = event.clientX - rect.left;\n    const total = rect.width;\n    let value = +this.min + (delta / total) * this.scope;\n    this.startValue = this.value;\n    this.updateValue(value, true);\n  }\n  onTouchStart = (event) => {\n    this.touchMixin.touchStart(event);\n    this.currentValue = this.value;\n    this.startValue = this.format(this.value);\n    this.dragStatus = 'start';\n  }\n  onTouchMove = (event) => {\n    const dragStart = this.options.dragStart;\n    if (this.dragStatus === 'start' && dragStart) {\n      if (isFn(dragStart)) {\n        dragStart();\n      } else {\n        console.warn('dragStart is not a function');\n      }\n    }\n    this.el.querySelector('.v-slider-bar').style.transition = 'none 0s ease 0s';\n    preventDefault(event, true);\n    this.touchMixin.touchMove(event);\n    this.dragStatus = 'draging';\n    const rect = this.el.getBoundingClientRect();\n    const delta = this.touchMixin.deltaX;\n    const total = rect.width;\n    const diff = (delta / total) * this.scope;\n\n\n    this.currentValue = this.startValue + diff;\n    this.updateValue(this.currentValue);\n  }\n  onTouchEnd = () => {\n    if (this.dragStatus === 'draging') {\n      this.updateValue(this.currentValue, true);\n      const dragEnd = this.options.dragEnd;\n      if (dragEnd) {\n        if (isFn(dragEnd)) {\n          dragEnd();\n        } else {\n          console.warn('dragEnd is not a function');\n        }\n      }\n    }\n    this.el.querySelector('.v-slider-bar').style.transition = null;\n    this.dragStatus = '';\n  }\n  bindTouchEvent = (el) => {\n    let onTouchStart = this.onTouchStart,\n        onTouchMove = this.onTouchMove,\n        onTouchEnd = this.onTouchEnd;\n    el.addEventListener('touchstart', onTouchStart);\n    el.addEventListener('touchmove', onTouchMove);\n\n    if (onTouchEnd) {\n      el.addEventListener('touchend', onTouchEnd);\n      el.addEventListener('touchcancel', onTouchEnd);\n    }\n  }\n  // 计算选中条长度百分比\n  calcMainAxis = () => {\n    const { value, min, scope } = this;\n    return `${((value - min) * 100) / scope}%`;\n  }\n  // 计算选中条开始位置的偏移量\n  calcOffset = () => {\n    const { value, min, scope } = this;\n    return null;\n  }\n  render = () => {\n    const barStyle = {\n      width: this.calcMainAxis(),\n      background: this.options.activeColor\n    };\n    const el = this.el.querySelector('.v-slider-bar');\n    el.style.width = barStyle.width;\n    el.style.background = barStyle.background;\n  }\n}\n\nexport default Slider;"],"names":["TouchMixin","event","resetTouchStatus","startX","touches","clientX","startY","clientY","touch","deltaX","deltaY","offsetX","Math","abs","offsetY","preventDefault","isStopPropagation","cancelable","stopPropagation","isFn","fn","getDom","el","document","querySelector","isDOM","HTMLElement","nodeType","nodeName","TypeError","Slider","options","html","style","background","inactiveColor","innerHTML","width","buttonSize","height","barHeight","value","end","format","input","change","call","console","warn","render","round","max","min","step","rect","getBoundingClientRect","delta","left","total","scope","startValue","updateValue","touchMixin","touchStart","currentValue","dragStatus","dragStart","transition","touchMove","diff","dragEnd","onTouchStart","onTouchMove","onTouchEnd","addEventListener","barStyle","calcMainAxis","activeColor","initHtml","bindTouchEvent","onClick"],"mappings":"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"}