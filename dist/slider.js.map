{"version":3,"file":"slider.js","sources":["../src/touchMixin.js","../src/util.js","../src/index.js"],"sourcesContent":["class TouchMixin {\n  constructor () {\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.offsetX = 0;\n    this.offsetY = 0;\n  }\n  touchStart = (event) => {\n    this.resetTouchStatus();\n    this.startX = event.touches[0].clientX;\n    this.startY = event.touches[0].clientY;\n  }\n  touchMove = (event) => {\n    var touch = event.touches[0];\n    this.deltaX = touch.clientX - this.startX;\n    this.deltaY = touch.clientY - this.startY;\n    this.offsetX = Math.abs(this.deltaX);\n    this.offsetY = Math.abs(this.deltaY);\n  }\n  resetTouchStatus = () => {\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.offsetX = 0;\n    this.offsetY = 0;\n  }\n}\n\nexport default TouchMixin;","export function preventDefault(event, isStopPropagation) {\n  if (typeof event.cancelable !== 'boolean' || event.cancelable) {\n    event.preventDefault();\n  }\n  if (isStopPropagation) {\n    event.stopPropagation();\n  }\n}\n\nexport function isFn (fn) {\n  return typeof fn === 'function';\n}\n\nexport function getDom (el) {\n  if (typeof el === 'string') {\n    el = document.querySelector(el);\n  }\n\n  var isDOM = typeof HTMLElement === 'object'\n    ? function (el) {\n        return el instanceof HTMLElement;\n      }\n    : function (el) {\n        return el && typeof el === 'object' && el.nodeType === 1 && typeof el.nodeName === 'string';\n      };\n  if (isDOM(el)) {\n    return el;\n  } else {\n    throw TypeError('el is not define');\n  }\n}","import TouchMixin from './touchMixin';\nimport { getDom, isFn, preventDefault } from './util';\nclass Slider {\n  constructor (options = {}) {\n    this.options = {\n      min: 0,\n      max: 100,\n      step: 1,\n      value: 0,\n      ...options\n    };\n    this.min = this.options.min;\n    this.max = this.options.max;\n    this.step = this.options.step;\n    this.value = this.options.value;\n    this.el = getDom(this.options.el);\n    this.dragStatus = '';\n    this.scope = this.max - this.min;\n    this.initHtml();\n    this.updateValue(this.value);\n    const el = this.el.querySelector('.v-slider__button-wrapper');\n    this.bindTouchEvent(el);\n    this.touchMixin = new TouchMixin();\n  }\n  initHtml = () => {\n    const html = `\n      <div class=\"v-slider-bar\">\n        <div class=\"v-slider__button-wrapper\">\n          <div class=\"v-slider__button\"></div>\n        </div>\n      </div>\n    `;\n    this.el.innerHTML = html;\n  }\n  updateValue = (value, end) => {\n    value = this.format(value);\n    const input = this.options.input;\n    const change = this.options.change;\n    if (input) {\n      if (isFn(input)) {\n        input.call(this, value);\n      } else {\n        console.warn(`input is not a function`);\n      }\n    }\n    if (end && change) {\n      if (isFn(change)) {\n        change.call(this, value);\n      } else {\n        console.warn('change is not a function');\n      }\n    }\n    this.value = value;\n    this.render();\n  }\n  format = (value) => {\n    return (\n      Math.round(Math.max(this.min, Math.min(value, this.max)) / this.step) * this.step\n    );\n  }\n  onTouchStart = (event) => {\n    this.touchMixin.touchStart(event);\n    this.currentValue = this.value;\n    this.startValue = this.format(this.value);\n    this.dragStatus = 'start';\n  }\n  onTouchMove = (event) => {\n    const dragStart = this.options.dragStart;\n    if (this.dragStatus === 'start' && dragStart) {\n      if (isFn(dragStart)) {\n        dragStart();\n      } else {\n        console.warn('dragStart is not a function');\n      }\n    }\n    preventDefault(event, true);\n    this.touchMixin.touchMove(event);\n    this.dragStatus = 'draging';\n    const rect = this.el.getBoundingClientRect();\n    const delta = this.touchMixin.deltaX;\n    const total = rect.width;\n    const diff = (delta / total) * this.scope;\n\n\n    this.currentValue = this.startValue + diff;\n    this.updateValue(this.currentValue);\n  }\n  onTouchEnd = () => {\n    if (this.dragStatus === 'draging') {\n      this.updateValue(this.currentValue, true);\n      const dragEnd = this.options.dragEnd;\n      if (dragEnd) {\n        if (isFn(dragEnd)) {\n          dragEnd();\n        } else {\n          console.warn('dragEnd is not a function');\n        }\n      }\n    }\n    this.dragStatus = '';\n  }\n  bindTouchEvent = (el) => {\n    let onTouchStart = this.onTouchStart,\n        onTouchMove = this.onTouchMove,\n        onTouchEnd = this.onTouchEnd;\n    el.addEventListener('touchstart', onTouchStart);\n    el.addEventListener('touchmove', onTouchMove);\n\n    if (onTouchEnd) {\n      el.addEventListener('touchend', onTouchEnd);\n      el.addEventListener('touchcancel', onTouchEnd);\n    }\n  }\n  // 计算选中条长度百分比\n  calcMainAxis = () => {\n    const { value, min, scope } = this;\n    return `${((value - min) * 100) / scope}%`;\n  }\n  // 计算选中条开始位置的偏移量\n  calcOffset = () => {\n    const { value, min, scope } = this;\n    return null;\n  }\n  render = () => {\n    const barStyle = {\n      width: this.calcMainAxis(),\n      background: this.options.activeColor\n    };\n    const el = this.el.querySelector('.v-slider-bar');\n    el.style.width = barStyle.width;\n    el.style.background = barStyle.background;\n  }\n}\n\nexport default Slider;"],"names":["TouchMixin","event","resetTouchStatus","startX","touches","clientX","startY","clientY","touch","deltaX","deltaY","offsetX","Math","abs","offsetY","preventDefault","isStopPropagation","cancelable","stopPropagation","isFn","fn","getDom","el","document","querySelector","isDOM","HTMLElement","nodeType","nodeName","TypeError","Slider","options","html","innerHTML","value","end","format","input","change","call","console","warn","render","round","max","min","step","touchMixin","touchStart","currentValue","startValue","dragStatus","dragStart","touchMove","rect","getBoundingClientRect","delta","total","width","diff","scope","updateValue","dragEnd","onTouchStart","onTouchMove","onTouchEnd","addEventListener","barStyle","calcMainAxis","background","activeColor","style","initHtml","bindTouchEvent"],"mappings":"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"}